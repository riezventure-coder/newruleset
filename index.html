<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auto Rule Generator</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { margin-bottom: 10px; }
    textarea, input { width: 100%; margin-bottom: 10px; padding: 8px; }
    button { padding: 10px 16px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #333; padding: 8px; text-align: left; }
    th { background: #eee; }
  </style>
</head>
<body>

<h1>Auto Rule Generator</h1>

<label>Text CRM</label>
<textarea id="crmText" rows="4" placeholder="Paste Text CRM di sini"></textarea>

<label>S-VLAN INTERNET</label>
<input type="text" id="svlanInternet" placeholder="contoh: 2685">

<label>S-VLAN VOICE</label>
<input type="text" id="svlanVoice" placeholder="contoh: 519">

<button onclick="generate()">Generate</button>

<table>
  <thead>
    <tr>
      <th>RESOURCE_ID</th>
      <th>SERVICE_NAME</th>
      <th>TARGET_ID</th>
      <th>CONFIG_ITEM_NAME</th>
    </tr>
  </thead>
  <tbody id="output"></tbody>
</table>

<script>
function generate() {
  const crm = document.getElementById("crmText").value;
  const svlanInternet = document.getElementById("svlanInternet").value;
  const svlanVoice = document.getElementById("svlanVoice").value;

  // üî• Ambil semua Service ID
  const services = [...crm.matchAll(/Service ID is\s*([^\s]+)/gi)]
                    .map(m => m[1]);

  const output = document.getElementById("output");
  output.innerHTML = "";

  services.forEach(service => {

    // Service_Port (TARGET_ID dikosongkan)
    output.innerHTML += `
      <tr>
        <td>12103477-75980417</td>
        <td>${service}</td>
        <td></td>
        <td>Service_Port</td>
      </tr>
    `;

    // INTERNET ‚Üí S-Vlan
    if (service.includes("_INTERNET") && svlanInternet) {
      output.innerHTML += `
        <tr>
          <td>${svlanInternet}</td>
          <td>${service}</td>
          <td></td>
          <td>S-Vlan</td>
        </tr>
      `;
    }

    // VOICE ‚Üí S-Vlan
    if (service.includes("_VOICE") && svlanVoice) {
      output.innerHTML += `
        <tr>
          <td>${svlanVoice}</td>
          <td>${service}</td>
          <td></td>
          <td>S-Vlan</td>
        </tr>
      `;
    }

    // IPTV ‚ùå tidak dibuatkan S-Vlan
  });
}
</script>

</body>
</html>
