<script>
function generate() {
  const crm = document.getElementById('crmText').value;

  // Ambil SEMUA Service ID (INTERNET / VOICE / IPTV)
  const services = [...crm.matchAll(/Service ID is\s*([^\s]+)/gi)]
                    .map(m => m[1]);

  const output = document.getElementById('output');
  output.innerHTML = '';

  services.forEach(service => {

    // Service_Port (TARGET_ID dikosongkan)
    output.innerHTML += `
      <tr>
        <td>12103477-75980417</td>
        <td>${service}</td>
        <td></td>
        <td>Service_Port</td>
      </tr>
    `;

    // INTERNET → S-Vlan
    if (service.includes('_INTERNET')) {
      output.innerHTML += `
        <tr>
          <td>2685</td>
          <td>${service}</td>
          <td></td>
          <td>S-Vlan</td>
        </tr>
      `;
    }

    // VOICE → S-Vlan
    if (service.includes('_VOICE')) {
      output.innerHTML += `
        <tr>
          <td>519</td>
          <td>${service}</td>
          <td></td>
          <td>S-Vlan</td>
        </tr>
      `;
    }

    // IPTV ❌ tidak ada S-Vlan
  });
}
</script>
